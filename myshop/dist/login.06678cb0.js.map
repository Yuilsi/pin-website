{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,SCAAC,EAAAD,EAAA,sBDGAE,OAAOC,iBAAiB,QAAQ,KAM9B,MAAMC,EAAiBC,SAASC,eAAe,kBAsB/C,IAAIC,EApBJH,EAAeD,iBAAiB,UAAUK,MAAOC,IAC/CA,EAAEC,iBAEF,MAIMC,EAAU,MAJHP,EAAeQ,KAAKC,YACnBT,EAAeU,MAAMD,eAClBT,EAAeW,SAASF,MAMvCG,SAAQ,GAEJC,QCpBVT,eAA0BU,GAJ1BJ,MAIgCA,EAJhCC,SAIsCA,IAClC,IACEI,QAAQC,IAAIN,EAAOC,GACnB,MAPNR,KAOaA,SAAcc,EAAAC,+BAA+BJ,EAAMJ,EAAOC,GACjE,OAAOR,EAIR,MAAME,GAEI,0BAAVA,EAAEc,MACHC,MAAM,6CAEK,8BAAVf,EAAEc,MACHC,MAAM,6BDMmBC,CAAW1B,EAAAmB,KAAKP,SC+B3CH,eAAiCkB,EAAGC,EAAOC,GACzC,UACU3B,EAAA4B,OAAO5B,EAAA6B,IAAIJ,EAAI,QAASC,GAAQC,GACxC,MAAOnB,GACLU,QAAQC,IAAIX,IDlCXsB,CAAkBhC,EAAA2B,GAAGT,EAAYe,IAAIrB,GAC1CsB,SAASC,KAAM,aACjBf,QAAQC,IAAIH,MAKZ,MAAMkB,EAAY9B,SAASC,eAAe,aAE1C6B,EAAUhC,iBAAiB,UAAUK,MAAOC,IAC1C,IACEA,EAAEC,iBACF,MAAM0B,EAASD,EAAUE,iBAAiB,SACpCC,EAAO,GACbF,EAAOG,SAAQC,GAASF,EAAKE,EAAM5B,MAAQ4B,EAAM3B,QACjDN,QCFJC,eAAqBU,EAAMJ,EAAMC,GAC/B,IACA,MAxCJR,KAwCWA,SAAcc,EAAAoB,2BAA2BvB,EAAKJ,EAAMC,GAE3D,OADAI,QAAQC,IAAIb,GACLA,EACL,MAAOE,GAGM,wBAAVA,EAAEc,MACHC,MAAM,yBAEK,wBAAVf,EAAEc,MACHC,MAAM,qBDVKkB,CAAM3C,EAAAmB,KAAKoB,EAAKK,SAASL,EAAKvB,UAC3C,MAAMa,QCjBXpB,eAAuBkB,EAAInB,GACxB,MAAMqC,EAAS3C,EAAA6B,IAAIJ,EAAI,QAASnB,EAAKyB,KAC/Ba,QAAgB5C,EAAA6C,OAAOF,GAE7B,GAAIC,EAAQE,SAEV,OADA5B,QAAQC,IAAI,iBAAkByB,EAAQP,QAC/BO,EAGP1B,QAAQC,IAAI,qBDQW4B,CAAQjD,EAAA2B,GAAGnB,GAClCY,QAAQC,IAAIQ,EAASU,OAAOtB,SACzBY,EAASU,OAAOtB,QACjBiB,SAASC,KAAM,qBAEfD,SAASC,KAAM,aAEjB,MAAMe,GACN9B,QAAQ+B,MAAMD,UAWpB,MAAME,EAAe9C,SAASC,eAAe,UACvC8C,EAAe/C,SAASC,eAAe,UACvC+C,EAAYhD,SAASC,eAAe,aAE1C6C,EAAahD,iBAAiB,SAAS,KACtCkD,EAAUC,UAAUC,IAAI,yBAGzBH,EAAajD,iBAAiB,SAAS,KACtCkD,EAAUC,UAAUE,OAAO,yBAI5BtD,OAAOC,iBAAiB,oBAAqBsD,IAErB,aADAC,aAAaC,QAAQ,gBAEvCN,EAAUC,UAAUC,IAAI","sources":["src/scripts/login.js","src/scripts/functions/auth.js"],"sourcesContent":["import { db, auth } from \"./app\";\r\nimport { login, createUser, addUserToDatabase, getUser } from \"./functions/auth\";\r\n\r\nwindow.addEventListener(\"load\", () => {\r\n  \r\n  // Import the functions you need from the SDKs you need\r\n  \r\n  \r\n  //--------------------------SIGN UP---------------------------------\r\n  const createUserForm = document.getElementById(\"createUserForm\");\r\n  //const loginForm = document.getElementById(\"loginForm\");\r\n  createUserForm.addEventListener(\"submit\", async (e) =>{\r\n    e.preventDefault();\r\n    \r\n    const name = createUserForm.name.value;\r\n    const email = createUserForm.email.value;\r\n    const password = createUserForm.password.value;\r\n  \r\n    const newUser = {\r\n      name,\r\n      email,\r\n      password,\r\n      isAdmin:false,\r\n    }\r\n    const userCreated= await createUser(auth,newUser);\r\n   await addUserToDatabase(db,userCreated.uid,newUser);\r\n    location.href= \"index.html\"\r\n  console.log(userCreated);\r\n  });\r\n   //--------------------------LOGIN--------------------------------\r\n  \r\n  let user;\r\n  const loginForm = document.getElementById(\"loginForm\");\r\n  \r\n  loginForm.addEventListener(\"submit\", async (e) =>{\r\n    try {   \r\n      e.preventDefault();\r\n      const inputs = loginForm.querySelectorAll(\"input\");\r\n      const data = {};\r\n      inputs.forEach(input => data[input.name] = input.value);\r\n      user = await login(auth,data.username,data.password);\r\n      const userInfo = await getUser(db,user);\r\n      console.log(userInfo.data().isAdmin);\r\n      if(userInfo.data().isAdmin){\r\n        location.href= \"createProduct.html\";\r\n      }else{\r\n        location.href= \"index.html\"\r\n      }\r\n    } catch(e) {\r\n      console.error(e);\r\n    }\r\n    \r\n    });\r\n  \r\n     \r\n\r\n})\r\n\r\n//--------------------estilo------------------------\r\n\r\nconst signUpButton = document.getElementById('signUp');\r\nconst signInButton = document.getElementById('signIn');\r\nconst container = document.getElementById('container');\r\n\r\nsignUpButton.addEventListener('click', () => {\r\n\tcontainer.classList.add(\"right-panel-active\");\r\n});\r\n\r\nsignInButton.addEventListener('click', () => {\r\n\tcontainer.classList.remove(\"right-panel-active\");\r\n});\r\n\r\n\r\nwindow.addEventListener('DOMContentLoaded', (event) => {\r\n    const loginAction = localStorage.getItem(\"loginAction\");\r\n    if (loginAction === \"register\") {\r\n      container.classList.add(\"right-panel-active\");\r\n    }\r\n});","import { doc,setDoc,getDoc } from \"firebase/firestore\";\r\nimport { createUserWithEmailAndPassword,signInWithEmailAndPassword } from \"firebase/auth\";\r\n\r\n\r\nasync function createUser(auth,{email,password}){\r\n    try{\r\n      console.log(email, password);\r\n      const {user} = await createUserWithEmailAndPassword(auth, email, password);\r\n      return user;\r\n      //adicionar la infomaci칩n del usuario\r\n\r\n     // alert(`bienvenido, usuario ${user.email}`);    //esto cambiarlo por el id despues\r\n    }catch(e){\r\n  \r\n  if(e.code ===\"auth/invalid-password\"){\r\n    alert(\"tu contrase침a debe tener min 6 caracteres\");\r\n  }\r\n  if(e.code ===\"auth/email-already-in-use\"){\r\n    alert(\"el correo ya esta en uso\");\r\n  }\r\n    }\r\n  \r\n  }\r\n\r\n async function getUser(db, user){\r\n    const docRef = doc(db, \"users\", user.uid);\r\n    const docSnap = await getDoc(docRef);\r\n\r\n    if (docSnap.exists()) {\r\n      console.log(\"Document data:\", docSnap.data());\r\n      return docSnap;\r\n    } else {\r\n      // doc.data() will be undefined in this case\r\n      console.log(\"No such document!\");\r\n    }\r\n    \r\n  }\r\n  \r\n  async function login(auth, email,password){\r\n    try {\r\n    const {user} = await signInWithEmailAndPassword(auth,email,password);\r\n    console.log(user);\r\n    return user;\r\n    } catch (e) {\r\n    // alert(\"corrreo o contrase침a invalda : (\");\r\n    //  console.log(e)\r\n      if(e.code ===\"auth/wrong-password\"){\r\n        alert(\"contrase침a incorrecta\");\r\n      }\r\n      if(e.code ===\"auth/user-not-found\"){\r\n        alert(\"correo no existe\");\r\n      }\r\n    }\r\n  }\r\n\r\n  async function addUserToDatabase(db,userId,userInfo){\r\n    try { \r\n        await setDoc(doc(db, \"users\", userId),userInfo);  \r\n    } catch (e) {\r\n        console.log(e);\r\n    }\r\n  }\r\n  export {\r\n      createUser,\r\n      login,\r\n      addUserToDatabase,// getUser\r\n      getUser\r\n  }"],"names":["$li1Mx","parcelRequire","$etBjH","window","addEventListener","createUserForm","document","getElementById","user","async","e","preventDefault","newUser","name","value","email","password","isAdmin","userCreated","auth","console","log","$1tHc5","createUserWithEmailAndPassword","code","alert","$9a41b7ebdf9580fc$export$3493b8991d49f558","db","userId","userInfo","setDoc","doc","$9a41b7ebdf9580fc$export$9f9c8eae0fddfad1","uid","location","href","loginForm","inputs","querySelectorAll","data","forEach","input","signInWithEmailAndPassword","$9a41b7ebdf9580fc$export$596d806903d1f59e","username","docRef","docSnap","getDoc","exists","$9a41b7ebdf9580fc$export$7cbf767827cd68ba","e1","error","$3f9d32fa80182a14$var$signUpButton","$3f9d32fa80182a14$var$signInButton","$3f9d32fa80182a14$var$container","classList","add","remove","event","localStorage","getItem"],"version":3,"file":"login.06678cb0.js.map"}