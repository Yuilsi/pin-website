{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,gDCAAC,EAAAD,EAAA,SDMA,MAAME,EAAWC,SAASC,eAAe,QACnCC,EAAaF,SAASC,eAAe,cACrCE,EAAgBH,SAASC,eAAe,iBAE9C,IAEIG,EAFAC,EAAO,GAGPC,EAAO,EACPC,EAAQ,GAEZ,SAASC,EAASC,GACdH,EAAO,EACPG,EAAKC,SAAQC,IACT,MAnBRC,KAmBgBA,EAnBhBC,MAmBsBA,GAAUF,EAClBG,EAAe,MACjBF,QACAC,GAEJN,EAAMQ,KAAKD,GAGXR,GAASU,SAASL,EAAQE,OAAOF,EAAQM,QAQjD,SAAuBN,GACnB,MAAMG,EAAed,SAASkB,cAAc,OAC5CJ,EAAaK,UAAY,WAEzBL,EAAaM,UAAY,uBAYzBT,EAAAU,OAAA,yFAGKV,EAAiBC,yDAERD,EAAYM,wDAC3BK,EAAAC,eAAAZ,EAAAE,kIAQCX,EAAasB,YAASV,GApClBW,CAAcd,GACdR,EAAcuB,UAAYJ,EAAAC,eAAejB,QAqCpCqB,iBAAA,UAAAC,MACDF,UAAApB,OAEJqB,iBAAK,UAAAE,MAAAD,+BAERE,IAAA,WAED,MAAMC,EAAAhC,EAAAgC,KAAAC,MAEPC,EAAAlC,EAAAmC,KAAAF,MAKKG,EAAM,CACRC,MAFNrC,EAAAqC,MAAAJ,MAGMD,KAAAA,EACAE,UAAAA,EACAI,MAAA9B,EACD+B,WAAAA,kBCpFLT,eAAyBU,EAAIF,EAAOG,GAChC,UACU1C,EAAA2C,OAAO3C,EAAA4C,IAAIH,EAAI,SAAUC,GAAS,OACpCH,IAEJM,QAAQb,IAAI,eACd,MAAOF,GACLe,QAAQb,IAAIF,IDoFnBgB,CAAAhD,EAAA2C,GAAAJ,EAAA/B,EAAAyC","sources":["src/scripts/checkout.js","src/scripts/functions/checkout.js"],"sourcesContent":["import { auth, db } from \"./app\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { getFirebaseCart } from \"./functions/cart\";\r\nimport { currencyFormat } from \"../utils/index\";\r\nimport { addOrder } from \"./functions/checkout\";\r\n\r\nconst dataForm = document.getElementById(\"data\");\r\nconst finalOrder = document.getElementById(\"finalOrder\");\r\nconst checkoutTotal = document.getElementById(\"checkoutTotal\");\r\n\r\nlet cart = [];\r\n\r\nlet userLogged = undefined;\r\nlet total= 0;\r\nlet order = [];\r\n\r\nfunction loadCart(cart) {\r\n    total =0;\r\n    cart.forEach(product => {\r\n        const { name, price } = product;\r\n        const orderProduct = {\r\n            name,\r\n            price\r\n        } \r\n        order.push(orderProduct);\r\n\r\n        \r\n        total += parseInt(product.price)*product.counter;\r\n\r\n        renderProduct(product);\r\n        checkoutTotal.innerText = currencyFormat(total);\r\n    });\r\n};\r\n\r\n\r\nfunction renderProduct(product) {\r\n    const orderProduct = document.createElement(\"div\");\r\n    orderProduct.className = \"shopping\";\r\n\r\n    orderProduct.innerHTML = `\r\n        <img src=\"${product.images[0]}\" alt=\"\" class=\"shopping__image\">\r\n        \r\n            <h3 class=\"shopping__name\">${product.name}</h3>\r\n            <h3 class=\"shopping__counter\"> ${product.counter}</h3>\r\n            <h3 class=\"shopping__info\">${currencyFormat(product.price)}</h3>\r\n            <div>\r\n    \r\n            <button class=\"shopping__delete\">Eliminar</button>\r\n         </div>\r\n        `;\r\n\r\n    finalOrder.appendChild(orderProduct);\r\n}\r\n\r\ndataForm.addEventListener(\"change\", e => {\r\n   \r\n    checkoutTotal.innerText = total;\r\n});\r\n\r\ndataForm.addEventListener(\"submit\", async (e) => {\r\n    e.preventDefault();\r\n    console.log(\"clicked\");\r\n\r\n    const city = dataForm.city.value;\r\n    const cellphone = dataForm.cell.value;\r\n    const email= dataForm.email.value;\r\n    const orderComplete = {\r\n        email,\r\n        city, \r\n        cellphone,  \r\n        order,\r\n        finalTotal\r\n    }\r\n\r\n    await addOrder(db, orderComplete, userLogged.uid);\r\n\r\n});\r\n\r\n\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    if (user) {\r\n      // User is signed in, see docs for a list of available properties\r\n      // https://firebase.google.com/docs/reference/js/firebase.User\r\n      userLogged = user;\r\n      cart = await getFirebaseCart(db, userLogged.uid);\r\n    } \r\n\r\n     loadCart(cart); \r\n\r\n  });\r\n\r\n \r\n /*  email.sendForm(service_id, template_id, myform[0])\r\n  .then(() => {\r\n      \r\n      document.querySelector('#loaders').appendChild(check);\r\n\r\n      setTimeout(() => {\r\n          cart.vaciarLocalStorage();\r\n          check.remove();\r\n          window.location = \"index.html\";\r\n      }, 2000);\r\n\r\n\r\n  }, (err) => {\r\n      alert(\"Error al enviar el email\\r\\n Response:\\n \" + JSON.stringify(err));\r\n      // myform.find(\"button\").text(\"Send\");\r\n  });\r\n */\r\n\r\n\r\n","import { setDoc, doc } from \"firebase/firestore\";\r\n\r\nasync function addOrder (db, order, userId) {\r\n    try {\r\n        await setDoc(doc(db, \"orders\", userId), {\r\n            order\r\n        });\r\n        console.log(\"order added\");\r\n    } catch (e) {\r\n        console.log(e);\r\n    }\r\n}\r\n\r\nexport {\r\n    addOrder\r\n}"],"names":["$li1Mx","parcelRequire","$etBjH","$4db3bec6fafbd9fd$var$dataForm","document","getElementById","$4db3bec6fafbd9fd$var$finalOrder","$4db3bec6fafbd9fd$var$checkoutTotal","$4db3bec6fafbd9fd$var$userLogged","$4db3bec6fafbd9fd$var$cart","$4db3bec6fafbd9fd$var$total","$4db3bec6fafbd9fd$var$order","$4db3bec6fafbd9fd$var$loadCart","cart","forEach","product","name","price","orderProduct","push","parseInt","counter","createElement","className","innerHTML","images","$2EF88","currencyFormat","appendChild","$4db3bec6fafbd9fd$var$renderProduct","innerText","addEventListener","e","async","log","city","value","cellphone","cell","orderComplete","email","order","finalTotal","db","userId","setDoc","doc","console","$da4a41300d9b9972$export$e0b7ffbb35a861bd","uid"],"version":3,"file":"checkout.f44a605f.js.map"}