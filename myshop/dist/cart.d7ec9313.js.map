{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,6DAMA,MAAMC,EAAcC,SAASC,eAAe,QACtCC,EAAeF,SAASC,eAAe,gBACvCE,EAAcH,SAASC,eAAe,eAG5C,IACIG,EADAC,EAAO,GAGX,SAASC,EAASC,GACd,IAAIC,EAAQ,EACZD,EAAKE,SAAQC,KAyBjB,SAAuBA,GACnB,MAAMC,EAAcX,SAASY,cAAc,MAC3CD,EAAYE,UAAY,UACxBF,EAAYG,UAAY,mBAcxBJ,EAAeK,OAAA,mEAIaL,EAAQM,6CACNC,EAAAC,eAAUR,EAAAS,kDAE/BT,EAAAU,sGAaTrB,EAAIsB,YAAcV,KAGdW,iBAAA,SAA8BC,IACP,WAAhBA,EAAAC,OAASC,UAErBC,QAAAC,IAAA,cA5DHC,eAA6BC,GACzB,MAAMC,EAAUzB,EAAK0B,QAAOrB,GAAWA,EAAQsB,KAAOH,IAEtDxB,EAAOyB,EAEH1B,SACM6B,EAAAC,mBAAmBrC,EAAAsC,GAAI/B,EAAWgC,IAAKN,GAGjDb,EAAAoB,iBAAiBP,GAEjB/B,EAAYe,UAAY,GAExBR,EAASwB,GAmDbQ,CAAA5B,EAAAsB,QAvEQO,CAAc7B,GACdF,GAASgC,SAAS9B,EAAQS,OAAOT,EAAQU,WAG7ClB,EAAauC,UAAYxB,EAAAC,eAAeV,GAE5CkB,QAAQC,IAAK,WAqEPL,iBAAkB,SAAAC,uBAQXmB,MAATtC,EAASuC,MAAI","sources":["src/scripts/cart.js"],"sourcesContent":["import { auth, db } from \"./app\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { getFirebaseCart, createFirebaseCart } from \"./functions/cart\";\r\nimport { addProductToCart } from \"../utils\";\r\nimport { getMyLocalCart, currencyFormat } from \"../utils/index\";\r\n\r\nconst cartSection = document.getElementById(\"cart\");\r\nconst totalSection = document.getElementById(\"totalSection\");\r\nconst checkoutBtn = document.getElementById(\"checkoutBtn\");\r\n/* const deleteAll = document.getElementById(\"product__delete\"); */\r\n\r\nlet cart = [];\r\nlet userLogged = undefined;\r\n\r\nfunction loadCart(cart) {\r\n    let total = 0;\r\n    cart.forEach(product => {\r\n        renderProduct(product);\r\n        total += parseInt(product.price)*product.counter\r\n        //total += parseInt(product.price);\r\n    });\r\n    totalSection.innerText = currencyFormat(total);\r\n};\r\nconsole.log (\"estoy\")\r\nasync function removeProduct(productId) {\r\n    const newCart = cart.filter(product => product.id !== productId);\r\n    \r\n    cart = newCart;\r\n\r\n    if (userLogged) {\r\n        await createFirebaseCart(db, userLogged.uid, newCart);\r\n    }\r\n\r\n    addProductToCart(newCart);\r\n\r\n    cartSection.innerHTML = \"\";\r\n\r\n    loadCart(newCart);\r\n\r\n}\r\n \r\nfunction renderProduct(product) {\r\n    const productCart = document.createElement(\"li\");\r\n    productCart.className = \"product\";\r\n    productCart.innerHTML = `\r\n    <img src=\"${product.images[0]}\" class=\"product__image\">\r\n   \r\n    <h2 class=\"product__name\">${product.name}</h2>\r\n    <h3 class=\"product__price\">${currencyFormat(product.price)}</h3>\r\n    \r\n    <h3 class=\"cart__info\"> ${product.counter}</h3>\r\n    <div>\r\n    \r\n    <button class=\"product__delete\">Eliminar</button>\r\n </div>\r\n    `\r\n    ;\r\n\r\n    //dlete product\r\n   \r\n    cartSection.appendChild(productCart);\r\n\r\n    productCart.addEventListener(\"click\", e => {\r\n         if (e.target.tagName === \"BUTTON\") {\r\n             console.log(\"remove it!\");\r\n             removeProduct(product.id);\r\n             /* removeOneProduct(product.id) */\r\n         }\r\n    })\r\n\r\n\r\n};\r\n\r\n\r\ncheckoutBtn.addEventListener(\"click\", e => {\r\n    e.preventDefault();\r\n    \r\n    //Check if a user is logged before switching pages\r\n    if (userLogged == undefined) {\r\n        alert(\"Login to continue to checkout\");\r\n    } else {\r\n        //If logged in, go to checkout\r\n        window.location.href = \"./checkout.html\";\r\n    }\r\n});\r\n\r\n\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    if (user) {\r\n      // User is signed in, see docs for a list of available properties\r\n      // https://firebase.google.com/docs/reference/js/firebase.User\r\n      userLogged = user;\r\n      cart = await getFirebaseCart(db, userLogged.uid);\r\n    } else {\r\n        cart = getMyLocalCart();\r\n      // User is signed out\r\n      // ...\r\n    }\r\n\r\n    loadCart(cart);\r\n\r\n  });"],"names":["$li1Mx","parcelRequire","$ff14a25859eedfe9$var$cartSection","document","getElementById","$ff14a25859eedfe9$var$totalSection","$ff14a25859eedfe9$var$checkoutBtn","$ff14a25859eedfe9$var$userLogged","$ff14a25859eedfe9$var$cart","$ff14a25859eedfe9$var$loadCart","cart","total","forEach","product","productCart","createElement","className","innerHTML","images","name","$2EF88","currencyFormat","price","counter","appendChild","addEventListener","e","target","tagName","console","log","async","productId","newCart","filter","id","$hMt9z","createFirebaseCart","db","uid","addProductToCart","$ff14a25859eedfe9$var$removeProduct","$ff14a25859eedfe9$var$renderProduct","parseInt","innerText","undefined","alert"],"version":3,"file":"cart.d7ec9313.js.map"}